# ページIDのみをサポートする実装の概要

## 実装した変更点

### 1. Notionサービスの修正 (`notion_service.py`)

- データベースIDのサポートを削除し、ページIDのみを処理するように単純化
- ページIDの処理方法を改善：
  - ハイフン有り/無しの両方のフォーマットに対応
  - エラー時に代替フォーマット（ハイフン付き）を試行
  - 詳細なログ出力の追加

```python
# 親ページの設定
if parent_page_id:
    # ページIDとして使用（ハイフン付き/なしの両方に対応）
    page_id = parent_page_id.replace('-', '') if '-' in parent_page_id else parent_page_id
    parent = {"page_id": page_id}
```

### 2. 設定画面のUI更新 (`settings.html`)

- ラベルを「Notion親ページID」に変更
- 説明文をページIDのみに関する内容に簡略化
- ヘルプモーダルからデータベースIDの説明を削除

```html
<label for="notion_parent_page_id" class="form-label fw-bold">Notion親ページID（オプション）</label>
<div class="form-text">親ページIDを指定すると、そのページの子ページとして議事録が作成されます。指定しない場合、ワークスペース直下に作成されます。</div>
```

### 3. テストスクリプトの更新 (`test_notion.py`)

- データベースIDのテストを削除
- ページアクセスと子ページ作成のテストに特化
- さまざまなIDフォーマット（ハイフン有り/無し）の自動テスト機能

## テスト結果

テストスクリプトの実行により、次の点が確認できました：

- ページIDでのアクセスが成功 (`✅ ページへのアクセステスト: 成功`)
- 子ページ作成が成功 (`✅ 子ページ作成テスト: 成功`)

## 今後の注意点

1. **ユーザー向けガイダンス**:
   - 親ページとして使用したいページがAPIインテグレーションと共有されていることを確認するよう案内

2. **エラーハンドリング**:
   - ページIDの形式（ハイフン有り/無し）は両方サポート
   - Notionの権限エラーの場合は適切なエラーメッセージを表示

3. **インテグレーション共有**:
   - NotionのページはAPIインテグレーションと必ず共有する必要がある
   - 共有方法：ページの右上「...」→「接続を追加」→インテグレーション選択

これらの変更により、Notionとの連携がシンプルになり、エラーが発生しにくくなりました。ユーザーは親ページIDを指定するだけで、そのページの下に議事録が作成されるようになります。 